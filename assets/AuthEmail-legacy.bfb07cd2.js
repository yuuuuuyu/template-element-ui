System.register(["./index-legacy.dc0fa9f1.js","./ui-legacy.54996b8d.js"],(function(t,n){"use strict";var e,a,i;return{setters:[function(t){e=t.n,a=t.j,i=t.k},function(){}],execute:function(){var n=function(){var t=this,n=t._self._c;return n("el-form",{ref:"form",staticClass:"auth_email",attrs:{model:t.formData,rules:t.rules,"label-position":"left","v-loading":t.loading},nativeOn:{submit:function(n){return n.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[t.anonymousEmail?n("el-form-item",[t._v("安全邮箱："+t._s(t.anonymousEmail))]):t._e(),n("el-form-item",{attrs:{prop:"inputEmail"}},[n("el-input",{attrs:{placeholder:"请输入安全邮箱","prefix-icon":"el-icon-message"},model:{value:t.formData.inputEmail,callback:function(n){t.$set(t.formData,"inputEmail",n)},expression:"formData.inputEmail"}})],1),n("el-form-item",{attrs:{prop:"userInput"}},[n("el-input",{attrs:{placeholder:"请输入验证码"},model:{value:t.formData.userInput,callback:function(n){t.$set(t.formData,"userInput",n)},expression:"formData.userInput"}},[n("template",{slot:"append"},[n("el-button",{attrs:{disabled:t.buttonDisabled},on:{click:t.sendValidCode}},[n("CountDown",{ref:"countdownButton",attrs:{count:30},on:{start:function(n){t.buttonDisabled=!0},end:function(n){t.buttonDisabled=!1}}},[t._v(" 获取验证码 ")])],1)],1)],2)],1),n("el-form-item",[n("el-button",{staticStyle:{width:"100%"},attrs:{"native-type":"submit",type:"primary"}},[t._v(" 立即验证 ")])],1)],1)};t("default",e({data:function(){var t=this;return{loading:!1,formData:{id:null,userInput:null,inputEmail:null},rules:{inputEmail:[{validator:function(n,e,a){if(e){if(t.userEmail&&t.userEmail!==e)return a(new Error("邮箱不正确"));a()}else a(new Error("请输入安全邮箱"))},trigger:[]}],userInput:[{required:!0,message:"请输入验证码",trigger:"blur"},{min:4,max:6,message:"请输入正确的验证码",trigger:"blur"}]},buttonDisabled:!1}},computed:{userEmail:function(){return this.$store.user.email||""},anonymousEmail:function(){if(this.userEmail){var t=this.userEmail.split("@")[0].split(""),n=t.map((function(n,e){return 0===e||e===t.length-1?n:"*"})).join("");return"".concat(n,"@").concat(this.userEmail.split("@")[1])}return""}},methods:{sendValidCode:function(){var t=this;this.$refs.form.validateField("inputEmail",(function(n){n||(t.loading=!0,a({email:t.formData.inputEmail}).then((function(n){t.loading=!1,200===n.status?(t.formData.id=n.data.id,t.$refs.countdownButton.start()):t.$message.warning("验证邮件发送失败，请稍后重试")})).catch((function(){t.loading=!1})))}))},handleSubmit:function(){var t=this;this.$refs.form.validateField("userInput",(function(n){n||(t.loading=!0,i(t.formData).then((function(n){t.loading=!1,200===n.status?t.$emit("success",n.data):(t.$refs.form.resetFields(),t.$message.warning("验证失败"))})).catch((function(){t.loading=!1})))}))}}},n,[],!1,null,"b3ba98bb",null,null).exports)}}}));
