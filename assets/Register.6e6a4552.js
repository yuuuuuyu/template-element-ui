import{n as e,r as a}from"./index.c811c3b7.js";import"./ui.1d6f8af4.js";const t=function(e={}){let a=e.value;return"function"==typeof a&&(a=a()),e.label||(e.label={mobile:"手机号",idCard:"身份证号",tel:"电话",email:"邮箱"}[e.validType]||""),new Promise(((t,r)=>{if(null==a||!a.length)return e.required?r(`请输入${e.label}`):t();switch(e.validType){case"mobile":/^(?:(?:\+|00)86)?1\d{10}$/.test(String(a))?t():r(`${e.label}格式有误，请重新输入`);break;case"idCard":(e=>/^[1-9]\d{5}(?:18|19|20)\d{2}(?:0[1-9]|10|11|12)(?:0[1-9]|[1-2]\d|30|31)\d{3}[\dXx]$/.test(String(e)))(a)?t():r(`${e.label}格式有误，请重新输入`);break;case"tel":(e=>/^(?:(?:\d{3}-)?\d{8}|^(?:\d{4}-)?\d{7,8})(?:-\d+)?$/.test(String(e)))(a)?t():r(`${e.label}格式有误，请重新输入`);break;case"email":(e=>/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(String(e)))(a)?t():r(`${e.label}格式有误，请重新输入`);break;default:r(`不支持的validType: ${e.validType}`)}}))};const r=e({data(){return{loading:!1,formData:{mobile:null,token:null,name:null,company:null,password:null,checkPass:null,userInput:null},rules:{mobile:[{validator:()=>t({required:!0,validType:"mobile",value:()=>{var e;return null==(e=this.formData)?void 0:e.mobile}}),trigger:[]}],userInput:[{validator:()=>new Promise(((e,a)=>{this.$refs.InputSMS.valid().then((a=>{this.resData=a,e()})).catch((e=>{a(e)}))})),trigger:[]}],name:[{required:!0,message:"请输入姓名",trigger:"change"}],company:[{required:!0,message:"请输入工作单位",trigger:"change"}],password:[{validator:(e,a,t)=>{""===a?t(new Error("请输入密码")):(""!==this.formData.checkPass&&this.$refs.validForm.validateField("checkPass"),t())},trigger:"blur"},{min:6,max:30,message:"长度在 6 到 30 个字符",trigger:"blur"}],checkPass:[{validator:(e,a,t)=>{""===a?t(new Error("请再次输入密码")):a!==this.formData.password?t(new Error("两次输入密码不一致!")):t()},trigger:"blur"}]},resData:null}},methods:{sendValidCode(){this.$refs.validForm.validateField("mobile",(e=>{e||this.$refs.InputSMS.send()}))},register(){if(this.loading)return null;this.loading=!0,this.$refs.validForm.validate((async e=>{e?(this.formData.token=this.resData,a(this.formData).then((e=>{this.loading=!1,200===e.status?this.$alert("注册成功,请登录","注册成功",{confirmButtonText:"确定",callback:()=>{this.$router.replace({name:"登录"})}}):this.$message.error(e.data.message)})).catch((()=>{this.loading=!1}))):this.loading=!1}))}},created(){}},(function(){var e=this,a=e._self._c;return a("div",{staticClass:"flex-row align-center justify-center registerPage"},[a("div",{staticClass:"register-box"},[a("div",{staticClass:"title"},[e._v("注册账号")]),a("el-form",{ref:"validForm",attrs:{model:e.formData,rules:e.rules,"label-width":"100px","hide-required-asterisk":"",size:"medium"},nativeOn:{submit:function(a){return a.preventDefault(),e.register.apply(null,arguments)}}},[a("el-form-item",{attrs:{prop:"mobile",required:"",label:"手机号："}},[a("el-input",{model:{value:e.formData.mobile,callback:function(a){e.$set(e.formData,"mobile",a)},expression:"formData.mobile"}})],1),a("el-form-item",{attrs:{prop:"userInput",label:"验证码："}},[a("InputSMS",{ref:"InputSMS",attrs:{type:"register",mobile:e.formData.mobile},on:{click:e.sendValidCode}})],1),a("el-form-item",{attrs:{prop:"name",label:"姓名："}},[a("el-input",{model:{value:e.formData.name,callback:function(a){e.$set(e.formData,"name","string"==typeof a?a.trim():a)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{prop:"company",label:"工作单位："}},[a("el-input",{model:{value:e.formData.company,callback:function(a){e.$set(e.formData,"company","string"==typeof a?a.trim():a)},expression:"formData.company"}})],1),a("el-form-item",{attrs:{prop:"password",label:"设置密码："}},[a("InputPassword",{attrs:{autocomplete:"off"},model:{value:e.formData.password,callback:function(a){e.$set(e.formData,"password",a)},expression:"formData.password"}})],1),a("el-form-item",{attrs:{prop:"checkPass",label:"重复密码："}},[a("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.formData.checkPass,callback:function(a){e.$set(e.formData,"checkPass",a)},expression:"formData.checkPass"}})],1),a("el-form-item",{staticClass:"submit-item"},[a("el-button",{staticClass:"submit-button",attrs:{"native-type":"submit",type:"primary",loading:e.loading}},[e._v("确 认")])],1)],1),a("div",{staticClass:"flex-row"},[a("div",{staticClass:"flex-1"}),e._v(" 已有账号？"),a("el-link",{staticClass:"first",attrs:{type:"danger"},on:{click:function(a){return e.$router.push({name:"登录"})}}},[e._v(" 点击登录 ")])],1)],1),a("auth",{ref:"auth",attrs:{types:["captcha"]}})],1)}),[],!1,null,"39f357a3",null,null).exports;export{r as default};
